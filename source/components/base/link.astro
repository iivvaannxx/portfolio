---
import { Icon } from "astro-icon/components";
import type { HTMLAttributes } from "astro/types";

import { cn } from "@app/utils";

// Extend the default attributes for extra functionality.
export type Props = HTMLAttributes<"a"> & {
  label: string;

  withTooltip?: boolean;
  tooltipContent?: string;

  targetBlank?: boolean;
  withExternalLinkArrow?: boolean;
};

const {
  label,
  href,
  class: clazz,

  withTooltip = false,
  withExternalLinkArrow = false,
  targetBlank = false,
  tooltipContent = label,

  ...props
} = Astro.props;

const ariaLabel = `Link to "${label}"${targetBlank ? ` (opens in a new tab).` : "."}`;
const optionalAttrs = {
  ...(withTooltip && { "data-tippy-content": tooltipContent }),
  ...(targetBlank && { target: "_blank" }),
};
---

<a
  {...props}
  {...optionalAttrs}
  {href}
  aria-label={ariaLabel}
  rel="noopener noreferrer"
  class={cn("group", clazz)}
>
  {
    withExternalLinkArrow ? (
      <>
        <slot />
        <Icon
          name="lucide:arrow-up-right"
          class:list={[
            "relative bottom-[2px] right-px inline-block size-[0.8em] transition-transform duration-300",
            "lg:group-hover:-translate-y-1 lg:group-hover:translate-x-1 ",
            "group-focus-visible:-translate-y-1 group-focus-visible:translate-x-1",
          ]}
        />
      </>
    ) : (
      <slot />
    )
  }
</a>
