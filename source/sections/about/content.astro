---
import { CharacterView } from "@app/components/experience/views/character";
import MysteryButton from "@app/components/mystery-button.astro";
import ObservedSection from "@app/layouts/observed-section.astro";

import * as Carousel from "@app/components/ui/carousel";
import { Icon } from "astro-icon/components";
import MyTime from "./components/my-time.svelte";
import { Link } from "@app/components/base";

import DynamicClock from "./components/dynamic-clock.svelte";
import MyWeather from "./components/my-weather.svelte";
import FavoriteCarousel from "./components/favorite-carousel.svelte";

import { education } from "./lib/data";
import { getTranslations } from "@app/modules/i18n";
import { Image } from "astro:assets";
import Status from "./components/status.svelte";
import { socials } from "@app/lib/data/socials";

const { locale } = Astro.locals;
const formatter = new Intl.DateTimeFormat(locale, {
  month: "long",
  year: "numeric",
});

const translations = getTranslations(locale);
const t = translations.sections.about;
---

<ObservedSection
  id={t.id}
  class="mx-auto max-w-screen-xl px-4 sm:px-8 2xl:px-0 [&>h2]:pl-3 sm:[&>h2]:pl-6"
  order={4}
  title={t.title}
>
  <div
    data-bento-about
    class="mb-24 grid grid-cols-10 justify-center gap-4"
  >
    <article
      class="col-span-10 col-start-1 row-start-1 flex flex-col overflow-clip rounded-xl border bg-card p-6 pb-8 md:px-10 md:py-8 lg:flex-row"
    >
      <div class="w-full lg:max-w-[60ch]">
        <header class="flex items-center gap-4 font-header text-xl font-bold">
          <Image
            src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Hand%20gestures/Waving%20Hand%20Medium-Light%20Skin%20Tone.png"
            alt="Waving Hand Medium-Light Skin Tone"
            inferSize
            class="size-[1.5em]"
          />
          <h3 class="mt-3">Hey There!</h3>
        </header>

        <p
          class="mt-8 text-pretty text-base text-foreground/80"
          set:html={t.introduction[0]}
        />

        <p
          class="mt-6 text-pretty text-base text-foreground/80"
          set:html={t.introduction[1]}
        />
      </div>

      <div
        class="relative hidden h-44 xs:h-52 lg:h-full lg:grow [@media(width>=350px)]:block"
      >
        <div class="absolute inset-0 size-full">
          <div
            class="absolute left-[12.5%] top-[40%] aspect-square w-1/4 min-w-[80px] max-w-[4.5em] -translate-x-1/2 -translate-y-1/2 rotate-[75deg] animate-float xs:min-w-[5.5em] xs:max-w-[7.5em] lg:left-[25%] lg:top-[20%] xl:left-[18%] xl:top-[25%] xl:max-w-[8.5em]"
          >
            <Image
              src="/images/misc/pizza.png"
              alt="Pizza"
              width={128}
              height={128}
            />

            <p
              class="absolute bottom-1/4 left-0 -z-10 w-full min-w-max translate-x-1/2 -rotate-90 rounded-full border bg-[#1d1b1b] px-[1em] py-[0.5em] text-center font-header font-medium text-accent-foreground/80 text-2xs xs:bottom-1/3 xs:text-xs"
            >
              <span> ❤️ </span>
              <span class="ml-0.5"> Pizza </span>
            </p>
          </div>

          <div
            class="absolute left-1/2 top-[60%] aspect-square w-1/4 min-w-[80px] max-w-[4.5em] -translate-x-1/2 -translate-y-1/2 xs:min-w-[5.5em] xs:max-w-[7.5em] lg:top-[70%] xl:max-w-[8.5em]"
          >
            <Image
              src="/images/misc/dog.png"
              alt="Dog"
              width={128}
              height={128}
            />

            <p
              class="absolute -bottom-6 left-[55%] z-10 w-full min-w-max -translate-x-1/2 rounded-full border bg-[#1d1b1b] px-[1em] py-[0.5em] text-center font-header font-medium text-accent-foreground/80 text-2xs xs:text-xs"
            >
              <span> ❤️ </span>
              <span class="ml-0.5"> Dogs </span>
            </p>
          </div>

          <div
            class="lg-top-[30%] absolute left-[90%] top-[35%] aspect-square w-1/4 min-w-[80px] max-w-[4.5em] -translate-x-1/2 -translate-y-1/2 rotate-12 animate-float animate-delay-1000 xs:min-w-[5.5em] xs:max-w-[7.5em] xl:left-[85%] xl:max-w-[8.5em]"
          >
            <Image
              src="/images/misc/gamepad.png"
              alt="Gamepad"
              width={128}
              height={128}
              class="z-10"
            />

            <p
              class="absolute -bottom-6 left-1/2 -z-10 w-full min-w-max -translate-x-1/2 rounded-full border bg-[#1d1b1b] px-[1em] py-[0.5em] text-center font-header font-medium text-accent-foreground/80 text-2xs xs:text-xs"
            >
              <span> ❤️ </span>
              <span class="ml-0.5"> Games </span>
            </p>
          </div>
        </div>
      </div>
    </article>

    <article
      class="col-span-10 col-start-1 row-start-2 flex flex-col rounded-xl border bg-card p-6 md:col-span-5 md:col-start-6 md:row-start-4 md:px-8 md:py-6 lg:col-span-6 lg:-col-start-7 lg:row-span-2 lg:row-start-2 xl:!col-span-4 xl:col-start-1 xl:row-span-2 xl:row-start-2 xl:row-end-5"
    >
      <header
        class="flex w-full items-center gap-4 font-header text-xl font-bold"
      >
        <Image
          src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Travel%20and%20places/Glowing Star.png"
          alt="Fire"
          inferSize
          class="size-[1.3em]"
        />
        <h3 class="mt-1.5">Favorites</h3>
      </header>

      <FavoriteCarousel client:visible />
    </article>

    <article
      class="relative col-span-10 col-start-1 row-start-6 flex aspect-square w-full items-end justify-center overflow-clip rounded-xl border bg-card p-5 sm:max-h-[420px] md:col-span-5 md:col-start-1 md:!row-start-4 md:aspect-auto md:max-h-none md:px-8 md:py-10 lg:col-span-4 lg:col-start-1 lg:!row-start-4 xl:col-span-3 xl:col-start-5 xl:row-span-2 xl:!row-start-2 xl:aspect-square [@media(width>=600px)]:row-start-5"
    >
      <CharacterView
        className="pointer-events-none absolute inset-0 -top-4 size-full scale-100 xs:-top-8"
        client:load
      />

      <div
        class="absolute inset-0 top-1/2 z-20 h-1/2 w-full bg-card gradient-mask-t-50 lg:gradient-mask-t-60"
      >
      </div>

      <footer class="z-30 w-full">
        <button
          onclick={'alert("Show Contact Form")'}
          class="relative inline-flex h-10 w-full items-center justify-center gap-4 whitespace-nowrap rounded-md bg-primary px-6 text-base font-bold text-primary-foreground transition will-change-transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 focus:ring-offset-ring xs:h-12"
        >
          <div
            class="absolute -inset-0.5 -z-10 rounded-lg bg-gradient-to-b from-primary/70 to-primary opacity-75 blur"
          >
          </div>

          <Icon
            name="lucide:mail"
            class="size-[1.2em]"
          />
          <span> Get In Touch </span>
        </button>
      </footer>
    </article>

    <article
      class="col-span-10 col-start-1 row-start-5 rounded-xl border bg-card p-6 md:col-span-5 md:!col-start-1 md:!row-start-3 md:row-end-4 md:px-10 md:py-6 lg:!col-span-4 lg:col-start-4 lg:!row-start-3 lg:row-end-4 xl:!col-span-3 xl:col-start-8 xl:!row-start-2 [@media(width>=600px)]:col-span-5 [@media(width>=600px)]:col-start-6 [@media(width>=600px)]:row-start-4"
    >
      <header class="flex items-center gap-4 font-header text-xl font-bold">
        <DynamicClock
          class="size-[1.2em]"
          client:idle
        />
        <h3 class="mt-1.5">Time</h3>
      </header>

      <MyTime
        class="size-full"
        locale={Astro.locals.locale}
        client:idle
      />
    </article>

    <article
      class="col-span-10 col-start-1 row-start-4 flex flex-col rounded-xl border bg-card p-6 md:col-span-4 md:col-start-6 md:row-start-2 md:row-end-3 md:px-8 md:py-6 lg:!col-span-4 lg:col-start-1 lg:row-start-2 lg:row-end-3 xl:!col-span-4 xl:col-start-1 xl:!row-start-5 xl:!row-end-6 [@media(width>=600px)]:col-span-5"
    >
      <header class="flex items-center gap-4 font-header text-xl font-bold">
        <Image
          src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Bookmark.png"
          alt="Bookmark"
          inferSize
          class="size-[1.3em]"
        />
        <h3 class="mt-1.5">Links</h3>
      </header>

      <ul
        data-socials
        class="mt-6 grid grow grid-cols-4 grid-rows-2 gap-y-3 md:grid-cols-3 md:grid-rows-3 md:gap-y-0 lg:grid-cols-4 lg:grid-rows-2 xl:gap-y-2"
      >
        {
          socials.map(({ href, i18nKey, iconKey }, index) => {
            const translatedLabel = translations.socials[i18nKey];
            const position = index > 3 ? "bottom" : "top";

            return (
              <li class="size-fit self-center justify-self-center rounded-lg bg-background text-foreground transition duration-200 hover:bg-accent hover:text-accent-foreground hover:brightness-110">
                <Link
                  {href}
                  label={`${translatedLabel}`}
                  targetBlank
                  withTooltip={{
                    content: `${translatedLabel}`,
                    placement: position,
                  }}
                >
                  <Icon
                    name={iconKey}
                    class="box-content size-7 p-2 text-current md:size-8 lg:size-9"
                  />
                </Link>
              </li>
            );
          })
        }
      </ul>
    </article>

    <article
      class="relative col-span-10 col-start-1 row-start-3 rounded-xl border bg-card p-6 pb-8 md:col-span-5 md:col-start-6 md:row-span-2 md:row-start-2 md:px-10 md:py-8 lg:col-span-6 lg:col-start-5 lg:row-span-1 lg:row-start-4 xl:!col-span-6 xl:!col-start-5 xl:row-span-2"
    >
      <header class="flex items-center gap-4 font-header text-xl font-bold">
        <Image
          src="https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Graduation%20Cap.png"
          alt="Graduation Cap"
          inferSize
          class="size-[1.5em]"
        />

        <h3 class="mt-3">Education</h3>
      </header>

      <ul
        class="mt-6"
        aria-label="My Education"
      >
        {
          education.map((item) => {
            const { startDate, endDate } = item;
            const start = formatter.format(startDate);
            const end = formatter.format(endDate);

            return (
              <li>
                <Link
                  href={item.url}
                  label={`Official site of my university`}
                  class="text-balance font-sans text-lg font-bold transition duration-200 group-focus-within:text-primary lg:hover:text-primary"
                  targetBlank
                  withExternalLinkArrow
                >
                  <span>{item.title(locale)}</span>
                </Link>

                <div class="mt-2 text-balance text-base font-semibold text-muted-foreground/80 transition-colors duration-200">
                  <span>{item.location(locale)}</span>
                  <span class="opacity-50">{" | "}</span>
                  <span aria-label="">
                    <time
                      datetime={`${startDate.getFullYear()}-${startDate.getMonth() + 1}`}
                    >
                      {start}
                    </time>
                    {" - "}
                    <time
                      datetime={`${endDate.getFullYear()}-${endDate.getMonth() + 1}`}
                    >
                      {end}
                    </time>
                  </span>
                </div>

                <p
                  data-education-description
                  class="mt-8 max-w-[800px] text-pretty text-base text-foreground/80"
                  set:html={item.description(locale)}
                />
              </li>
            );
          })
        }
      </ul>
    </article>
  </div>
</ObservedSection>

<style>
  :global([data-education-description] a) {
    text-decoration: underline;
    text-decoration-color: theme("colors.primary.DEFAULT");
    text-underline-offset: 0.15em;
  }
</style>
